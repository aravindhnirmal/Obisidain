[[Keep/Colour/DEFAULT]] [[Keep/Archived]] 

%{
[[include]] <stdio.h>
%}

%token NAME NUMBER WHILE IF THEN LPAREN RPAREN LESS PLUS MOD LBRACE RBRACE SEMICOLON

%%

program: statement
       | program statement

statement: expression SEMICOLON
         | WHILE LPAREN expression LESS NUMBER RPAREN LBRACE statement RBRACE
         | WHILE LPAREN expression LESS NUMBER RPAREN LBRACE IF LPAREN expression MOD NUMBER EQUALS NUMBER SEMICOLON THEN statement RBRACE

expression: NUMBER
          | NAME
          | expression PLUS expression
          | LPAREN expression RPAREN
          | expression LESS expression
          | expression MOD expression

%%

int main() {
    yyparse();
    return 0;
}

void yyerror(char *s) {
    printf("Syntax Error: %s\n", s);
}

int i = 0;

int eval(int x, char op, int y) {
    switch (op) {
        case '+': return x + y;
        case '%': return x % y;
        default: printf("Invalid operator: %c\n", op); return 0;
    }
}

int execute_statement() {
    if (i % 2 == 0) i++;
    return i;
}

int execute_while(int a) {
    while (a < 10) {
        if (i % 2 == 0) i++;
        a++;
    }
    return a;
}

int execute_program() {
    int a = 0;
    while (a < 10) {
        if (i % 2 == 0) i++;
        a++;
        if (i % 2 == 0) i++;
        a = execute_while(a);
    }
    return i;
}

int yylex() {
    int token = yylex();
    if (token == LESS || token == PLUS || token == MOD) {
        yylval.op = yytext[0];
        return OPERATOR;
    }
    return token;
}

